<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Tiban Kaffe - Taste of Batam</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    
    <style>
        /* 1. Global Styles */
        body { font-family: 'Poppins', sans-serif; background-color: #fcf8f5; color: #4a4a4a; overflow-x: hidden; }
        h1, h2, h3, h4, .navbar-brand { font-family: 'Playfair Display', serif; }
        
        /* 2. Navbar Pintar */
        .navbar { transition: all 0.4s ease-in-out; padding: 1rem 0; }
        
        .navbar-transparent { background-color: transparent; }
        .navbar-scrolled {
            background-color: rgba(44, 30, 22, 0.98) !important;
            padding: 0.5rem 0;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .navbar-brand, .nav-link { color: #fff !important; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        .navbar-toggler { border-color: rgba(255,255,255,0.5); }
        .navbar-toggler-icon { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(255, 255, 255, 1)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e"); }

        /* KHUSUS MOBILE: Agar menu saat dibuka backgroundnya gelap & rapi */
        @media (max-width: 991px) {
            .navbar-collapse {
                background: rgba(44, 30, 22, 0.95);
                margin-top: 15px;
                padding: 20px;
                border-radius: 15px;
            }
            .navbar-transparent .navbar-collapse {
                background: rgba(44, 30, 22, 0.95); /* Tetap gelap meski di transparent mode */
            }
        }

        /* 3. Spacer Internal Page */
        .internal-page-spacer { padding-top: 100px; }

        /* 4. Footer & Map */
        footer { background-color: #1a120e; color: #d4a373; }
        
        /* Tombol & Card */
        .btn-coffee { background: linear-gradient(45deg, #d4a373, #b08968); color: white; border: none; }
        .btn-coffee:hover { background: linear-gradient(45deg, #b08968, #8c6a4d); color: white; transform: translateY(-2px); transition: 0.3s; }
        
        /* Card Responsif */
        .card-custom { border-radius: 15px; border: none; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body class="{% block body_class %}{% endblock %}">

    <nav class="navbar navbar-expand-lg fixed-top {% block navbar_class %}navbar-scrolled{% endblock %}" id="mainNavbar">
        <div class="container">
            <a class="navbar-brand fs-4 fw-bold" href="{% url 'home' %}">
                â˜• Tiban Kaffe
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item me-lg-3 my-2 my-lg-0">
                        <a class="nav-link" href="{% url 'home' %}">Home</a>
                    </li>
                    <li class="nav-item">
                        <a href="{% url 'cart_detail' %}" class="btn position-relative text-white border-white rounded-pill px-3 py-2 w-100 text-start text-lg-center">
                            <i class="bi bi-bag me-2"></i> Keranjang
                            <span id="cart-badge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger border border-light ms-lg-0 ms-n3">
                                {{ cart_count|default:"0" }}
                            </span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main style="min-height: 80vh;">
        {% block content %}
        {% endblock %}
    </main>

    <footer class="py-5 mt-auto">
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-5 col-12 order-lg-1 order-2">
                    <h5 class="text-white mb-3"><i class="bi bi-geo-alt-fill me-2"></i>Lokasi Kami</h5>
                    <div class="card border-0 overflow-hidden shadow">
                        <div class="ratio ratio-16x9">
                            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3989.057864483754!2d103.9961233142735!3d1.118619999183905!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31d98be6c3f3f5cd%3A0x6b7b7b7b7b7b7b7b!2sTiban%20Center!5e0!3m2!1sid!2sid!4v1629876543210!5m2!1sid!2sid" 
                                style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                        </div>
                    </div>
                    <p class="small text-white-50 mt-2">Jl. Gajah Mada, Tiban Indah, Kec. Sekupang, Kota Batam.</p>
                </div>

                <div class="col-lg-4 col-12 order-lg-2 order-1">
                    <h3 class="fw-bold text-white mb-3">Tiban Kaffe</h3>
                    <p class="text-white-50">Tempat nongkrong asik di Batam dengan cita rasa kopi premium dan suasana yang nyaman.</p>
                    <div class="d-flex gap-3 mt-3">
                        <a href="#" class="text-white fs-4"><i class="bi bi-instagram"></i></a>
                        <a href="#" class="text-white fs-4"><i class="bi bi-whatsapp"></i></a>
                        <a href="#" class="text-white fs-4"><i class="bi bi-facebook"></i></a>
                    </div>
                </div>

                <div class="col-lg-3 col-12 order-3">
                    <h5 class="text-white mb-3">Jam Buka</h5>
                    <ul class="list-unstyled text-white-50">
                        <li class="mb-2 d-flex justify-content-between"><span>Senin - Jumat</span> <span>10:00 - 22:00</span></li>
                        <li class="d-flex justify-content-between"><span>Sabtu - Minggu</span> <span>09:00 - 23:00</span></li>
                    </ul>
                </div>
            </div>
            <hr class="border-secondary my-4">
            <div class="text-center text-white-50 small">
                &copy; 2024 Tiban Kaffe Batam. Developed with Django.
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        // LOGIKA TRANSISI NAVBAR (Update Mobile)
        const navbar = document.getElementById('mainNavbar');
        const isHomePage = document.body.classList.contains('home-page-body');

        window.onscroll = function() {
            if (isHomePage) {
                if (window.scrollY > 50) {
                    navbar.classList.add('navbar-scrolled');
                    navbar.classList.remove('navbar-transparent');
                } else {
                    navbar.classList.remove('navbar-scrolled');
                    navbar.classList.add('navbar-transparent');
                }
            }
        };

        function addToCart(kopiId, kopiName) {
            fetch(`/add-to-cart/${kopiId}/`, {
                method: 'GET',
                headers: { 'X-Requested-With': 'XMLHttpRequest' }
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    document.getElementById('cart-badge').innerText = data.cart_count;
                    const Toast = Swal.mixin({
                        toast: true, position: 'top-end', showConfirmButton: false, 
                        timer: 3000, background: '#2c1e16', color: '#fff'
                    });
                    Toast.fire({ icon: 'success', title: `${kopiName} +1` });
                }
            });
        }
    </script>
</body>
</html>